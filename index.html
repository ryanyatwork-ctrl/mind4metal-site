<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mind4Metal Radio</title>
<meta name="description" content="Mind4Metal Radio â€” 24/7 Heavy â€¢ Power â€¢ Hard Rock">
<script src="https://cdn.tailwindcss.com"></script>
<style>.glass{background:rgba(24,24,27,.6);backdrop-filter:blur(6px)}</style>
</head>
<body class="min-h-screen text-zinc-100">
  <div class="fixed inset-0 -z-10 bg-center bg-cover" id="bg"></div>
  <div class="fixed inset-0 -z-10 bg-gradient-to-b from-black/70 via-black/65 to-black/80"></div>

 <header class="max-w-6xl mx-auto px-4 pt-8 pb-6 flex items-center justify-between">
  <div class="flex items-center gap-3">
    <div class="w-8 h-8 rounded bg-orange-500/20 border border-orange-400/40 flex items-center justify-center">ðŸŽ§</div>

    <div class="flex flex-col">
    <img
  src="/assets/mind4metal-logo.png"
  alt="Mind4Metal Radio"
  class="h-10 sm:h-12 w-auto drop-shadow-lg"
/>
      <p class="mt-1 text-xs sm:text-sm text-zinc-300 tracking-wide uppercase">
        24/7 Heavy Metal â€¢ Power Metal â€¢ Hard Rock
      </p>
    </div>
  </div>

  <nav class="hidden sm:flex gap-2">
    <a class="px-3 py-2 rounded-lg glass border border-white/10" href="https://facebook.com/Mind4MetalRadio" target="_blank">Facebook</a>
    <a class="px-3 py-2 rounded-lg glass border border-white/10" href="https://instagram.com/Mind4MetalRadio" target="_blank">Instagram</a>
    <a class="px-3 py-2 rounded-lg glass border border-white/10" href="https://x.com/Mind4MetalRadio" target="_blank">X</a>
    <a class="px-3 py-2 rounded-lg glass border border-white/10" href="mailto:requests@mind4metal.com">Email</a>
  </nav>
</header>


  <main class="max-w-6xl mx-auto px-4 pb-20 grid gap-6 lg:grid-cols-3">
 <section class="lg:col-span-2 rounded-2xl border border-white/10 glass p-5">
  <div class="flex items-center gap-5">
    <div class="w-28 h-28 rounded-xl bg-zinc-800 border border-white/10 flex items-center justify-center">ðŸŽµ</div>
    <div class="min-w-0 flex-1">
      <div class="text-sm uppercase tracking-widest text-orange-400 font-semibold">Now Playing</div>
      <h2 id="title" class="text-xl sm:text-2xl font-bold truncate">â€”</h2>
      <p id="artist" class="text-zinc-300 truncate">â€”</p>
      <div class="mt-3 flex items-center gap-3">
        <button id="listen" class="px-4 py-2 rounded-full bg-orange-500 hover:bg-orange-400 text-black font-semibold">Listen Live</button>
        <div class="text-xs text-zinc-400">Live â€¢ <span id="elapsed">0:00</span></div>
      </div>
    </div>
  </div>
  <audio id="audio" preload="none"></audio>
</section>


    <section class="lg:col-span-1 rounded-2xl border border-white/10 glass p-5">
      <div class="flex items-center gap-2 mb-3"><span>ðŸ“¨</span><h3 class="text-lg font-bold">Send a Request</h3></div>
      <form id="reqform" class="grid gap-3">
        <input name="name" required placeholder="Your name" class="px-3 py-2 rounded-lg bg-zinc-800/70 border border-white/10"/>
        <input name="artist" required placeholder="Artist" class="px-3 py-2 rounded-lg bg-zinc-800/70 border border-white/10"/>
        <input name="song" required placeholder="Song" class="px-3 py-2 rounded-lg bg-zinc-800/70 border border-white/10"/>
        <textarea name="message" rows="3" placeholder="Optional message" class="px-3 py-2 rounded-lg bg-zinc-800/70 border border-white/10"></textarea>
        <input type="text" name="website" class="hidden" tabindex="-1" autocomplete="off"/>
        <button class="px-4 py-2 rounded-lg bg-orange-500 hover:bg-orange-400 text-black font-semibold">Submit Request</button>
      </form>
    </section>

    <section class="lg:col-span-3 rounded-2xl border border-white/10 glass p-5">
      <div class="flex items-center gap-2 mb-3"><span>ðŸ“»</span><h3 class="text-lg font-bold">Recently Played</h3></div>
      <table class="min-w-full text-sm"><thead><tr class="text-left text-zinc-400">
        <th class="py-2 pr-4">Time</th><th class="py-2 pr-4">Title</th><th class="py-2 pr-4">Artist</th></tr></thead>
        <tbody id="historyBody"></tbody></table>
    </section>
  </main>

  <script>
    const BACKGROUND_URL="https://radio.mind4metal.com/assets/m4m-bg.jpg";
    const STREAM_URL="https://radio.mind4metal.com/stream.mp3";
    const ICECAST_STATUS_URL="https://radio.mind4metal.com/status-json.xsl";
    const REQUEST_POST_URL="https://formspree.io/f/mind4metal";

    bg.style.backgroundImage = "url("+BACKGROUND_URL+")";
    const audio=document.getElementById('audio'); audio.src=STREAM_URL;
    const listen=document.getElementById('listen'); const titleEl=document.getElementById('title');
    const artistEl=document.getElementById('artist'); const elapsed=document.getElementById('elapsed');
    const historyBody=document.getElementById('historyBody');
    let playing=false, startedAt=Date.now(), last=""; const hist=[];

    listen.onclick=async()=>{ try{ if(!playing){ await audio.play(); listen.textContent='Pause'; playing=true; } else { audio.pause(); listen.textContent='Listen Live'; playing=false; } }catch{} };
    setInterval(()=>{ const s=Math.max(0,Math.floor((Date.now()-startedAt)/1000)); elapsed.textContent=`${Math.floor(s/60)}:${String(s%60).padStart(2,'0')}`; },1000);

    function parseTA(s){ if(!s) return {title:'Unknown Track',artist:'Unknown Artist'}; const p=s.split(' - '); if(p.length>=2) return {artist:p[0],title:p.slice(1).join(' - ')}; const by=s.split(' by '); if(by.length>=2) return {title:by[0],artist:by.slice(1).join(' by ')}; return {title:s,artist:''}; }
    function renderHist(){ historyBody.innerHTML=hist.map(t=>`<tr class="border-t border-white/10"><td class="py-2 pr-4 text-zinc-300">${new Date(t.at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}</td><td class="py-2 pr-4 font-semibold">${t.title}</td><td class="py-2 pr-4 text-zinc-300">${t.artist}</td></tr>`).join(''); }

    async function poll(){ try{ const r=await fetch(ICECAST_STATUS_URL,{cache:'no-store'}); const j=await r.json();
      const src=Array.isArray(j?.icestats?.source)?j.icestats.source[0]:j?.icestats?.source;
      const raw=src?.title||src?.yp_currently_playing; const {title,artist}=parseTA(raw); const combo=`${artist} - ${title}`.trim();
      if(combo && combo!==last){ if(last){ hist.unshift({title:titleEl.textContent||'â€”',artist:artistEl.textContent||'â€”',at:startedAt}); if(hist.length>10) hist.pop(); renderHist(); }
        titleEl.textContent=title||'â€”'; artistEl.textContent=artist||'â€”'; startedAt=Date.now(); last=combo; }
    }catch(e){}}
    poll(); setInterval(poll,15000);

    document.getElementById('reqform').onsubmit=async(e)=>{ e.preventDefault(); const fd=new FormData(e.target);
      if(fd.get('website')) return; try{ if(REQUEST_POST_URL){ await fetch(REQUEST_POST_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(Object.fromEntries(fd.entries()))}); } alert('Request sent! ðŸ¤˜'); e.target.reset(); }catch{ alert('Couldn\\'t send right now.'); } };
  </script>
</body></html>
